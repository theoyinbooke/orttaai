================================================================================
UTTRAI BUILD CHECKLIST
================================================================================
Based on: uttrai-implementation-plan.md + uttrai-prd-v2.2.md
Track: Mark [x] when complete. Leave [ ] for pending. [BLOCKED] if stuck.

================================================================================
PHASE 0: PREREQUISITES & ENVIRONMENT SETUP
================================================================================

[SETUP]

[x] SETUP-1: Create .gitignore for Swift/Xcode
[x] SETUP-2: Initialize git repository
[x] SETUP-3: Create LICENSE (MIT) file
[MANUAL] SETUP-4: Create Xcode project in Xcode (macOS > App, SwiftUI, com.uttrai.app)
[MANUAL] SETUP-5: Configure Xcode: deployment target macOS 14, disable sandbox, enable Hardened Runtime
[MANUAL] SETUP-6: Add SPM dependencies in Xcode (WhisperKit, GRDB, Sparkle, KeyboardShortcuts)
[x] SETUP-7: Create Uttrai.entitlements file (audio-input, apple-events, hardened runtime, no sandbox)
[x] SETUP-8: Create folder structure on disk (App/, Core/, UI/, Data/, Design/, Utilities/, Resources/)
[MANUAL] SETUP-9: Add test target UttraiTests in Xcode with Core/ and Coordination/ subfolders
[MANUAL] SETUP-10: Verify project builds (Cmd+B) — commit "Project setup complete"

[MANUAL] CHECKPOINT-SETUP: All setup tasks verified complete — pending Xcode project creation (SETUP-4/5/6/9/10)

================================================================================
PHASE 1: FOUNDATION (Week 1–2)
================================================================================

--- Week 1, Day 1–2: Design System + Utilities ---

[x] TASK-1.1: Create Colors.swift — Color.init(hex:), Color.Uttrai.*, NSColor.Uttrai.*
[x] TASK-1.2: Create Typography.swift — Font.Uttrai.* (title, heading, subheading, body, bodyMedium, secondary, caption, mono, monoSmall)
[x] TASK-1.3: Create Spacing.swift — Spacing.*, CornerRadius.*, BorderWidth.*, WindowSize.*
[x] TASK-1.4: Create Errors.swift — UttraiError enum with all cases and LocalizedError conformance
[x] TASK-1.5: Create Logger.swift — os.Logger extensions with 8 categories (audio, transcription, injection, hotkey, ui, database, model, dictation)
[x] TASK-1.6: Create Extensions.swift — NSWorkspace.frontmostAppName, Bundle.isHomebrewInstall

--- Week 1, Day 2–3: Data Layer ---

[x] TASK-1.7: Create TranscriptionRecord.swift — Transcription struct (Codable, FetchableRecord, PersistableRecord)
[x] TASK-1.8: Create DatabaseManager.swift — init with directory creation, migration v1, CRUD, auto-prune, search, DatabaseRegionObservation
[x] TASK-1.9: Create DatabaseManagerTests.swift — in-memory GRDB, test insert/fetch/prune/search/deleteAll (6+ tests)
[x] TASK-1.10: Create AppSettings.swift — @AppStorage properties (selectedModelId, selectedAudioDeviceID, polishModeEnabled, launchAtLogin, hasCompletedSetup, showProcessingEstimate)

--- Week 1, Day 3–4: Hardware Detection ---

[x] TASK-1.11: Create HardwareDetector.swift — chip detection, Apple Silicon check, RAM, GPU cores, disk space, HardwareTier enum, recommendedModel()
[x] TASK-1.12: Create HardwareDetectorTests.swift — test tier detection, recommendedModel, RAM > 0

--- Week 1, Day 4–5: Audio Capture ---

[x] TASK-1.13: Create AudioCaptureService.swift — AVAudioEngine, private DispatchQueue, OSAllocatedUnfairLock, 16kHz tap format, 30fps level timer, startCapture/stopCapture
[x] TASK-1.14: Create AudioDeviceManager.swift — enumerate input devices, AudioInputDevice struct, device change listener
[x] TASK-1.15: Create AudioCaptureServiceTests.swift — [NEEDS-RUNTIME-TEST] test start/stop, samples non-empty, audioLevel updates

--- Week 1, Day 5: Clipboard & Injection Foundation ---

[x] TASK-1.16: Create ClipboardManager.swift — SavedItem struct, save() with type iteration + promise skipping, restore()
[x] TASK-1.17: Create ClipboardManagerTests.swift — round-trip text, multiple types, empty pasteboard, file URLs (4+ tests)

--- Week 2, Day 1–2: Hotkey Service ---

[x] TASK-1.18: Create HotkeyService.swift — CGEvent tap, start() returns Bool, C callback routing to onKeyDown/onKeyUp, stop()

--- Week 2, Day 2–3: App Shell ---

[x] TASK-1.19: Create AppDelegate.swift — NSApplicationDelegate, NSStatusItem creation, StatusBarMenu wiring, setup flow check
[x] TASK-1.20: Create UttraiApp.swift — @main, @NSApplicationDelegateAdaptor, hidden WindowGroup
[x] TASK-1.21: Create AppState.swift — @Observable, holds HardwareInfo + AppSettings + isSetupComplete
[x] TASK-1.22: Create StatusBarController.swift — manages NSStatusItem, icon state updates (idle/recording/processing/downloading/error)
[x] TASK-1.23: Create StatusBarMenu.swift — NSMenu with all items (status line, Polish Mode, History, Settings, Updates, Quit)
[x] TASK-1.24: Create WindowManager.swift — create/show NSWindows for setup (600x500), settings (500x400), history (480x600)

--- Week 2, Day 3–4: Floating Panel ---

[x] TASK-1.25: Create FloatingPanelController.swift — NSPanel config, NSVisualEffectView, NSHostingView, show(near:)/dismiss() with fade, AX cursor positioning
[x] TASK-1.26: Create WaveformView.swift — SwiftUI Canvas, 10 bars driven by audioLevel, amber color, 30fps animation
[x] TASK-1.27: Create ProcessingIndicatorView.swift — shimmer animation, processing estimate text, error state with auto-dismiss

--- Week 2, Day 4–5: UI Components ---

[x] TASK-1.28: Create UttraiButton.swift — UttraiButtonStyle (primary/secondary/ghost/destructive), hover, focus ring
[x] TASK-1.29: Create UttraiTextField.swift — styled TextField, dark bg, amber focus ring
[x] TASK-1.30: Create UttraiToggle.swift — UttraiToggleStyle, amber active, 150ms animation
[x] TASK-1.31: Create UttraiProgressBar.swift — UttraiProgressBarStyle, amber fill, 6pt height
[x] TASK-1.32: Create AudioLevelMeter.swift — GeometryReader + Rectangle, animated width
[x] TASK-1.33: Create ShortcutRecorderView.swift — KeyboardShortcuts.Recorder wrapper, styled to match

[x] CHECKPOINT-PHASE1: Phase 1 verified — all code written, tests written, pending Xcode project for build verification

================================================================================
PHASE 2: CORE PIPELINE (Week 3–4)
================================================================================

--- Week 3, Day 1–2: Transcription ---

[x] TASK-2.1: Create TranscriptionService.swift — actor, WhisperKit init/load/transcribe/unload/warmUp
[x] TASK-2.2: Create TextProcessor.swift — protocol, TextProcessorInput/Output, ProcessingMode enum, PassthroughProcessor

--- Week 3, Day 2–3: Text Injection ---

[x] TASK-2.3: Create TextInjectionService.swift — isFocusedElementSecure(), inject() with secure field check BEFORE lastTranscript, simulatePaste() with 10ms key spacing, 250ms restore delay, InjectionResult enum
[x] TASK-2.4: Create TextInjectionServiceTests.swift — test blockedSecureField, lastTranscript not set on block, lastTranscript set on success

--- Week 3, Day 3–4: Model Management ---

[x] TASK-2.5: Create ModelDownloader.swift — URLSession background download, progress delegate, resume, SHA256, exponential backoff, UNUserNotificationCenter
[x] TASK-2.6: Create ModelManager.swift — @Observable, state tracking, download/load/switch/verify/delete, directory creation

--- Week 3, Day 4–5: DictationCoordinator ---

[x] TASK-2.7: Create DictationCoordinator.swift — State enum, startRecording/stopRecording, cap timer (35s countdown, 45s stop), processingMs measurement, autoDismissError, <0.5s skip
[x] TASK-2.8: Create DictationCoordinatorTests.swift — mock services, test all state transitions (idle→recording→processing→injecting→idle, error paths, cap timer, <0.5s skip, secure field block) (8+ tests)

--- Week 3 Day 5 – Week 4 Day 1: Integration ---

[x] TASK-2.9: Wire end-to-end in AppDelegate — create all services, inject into coordinator, wire hotkey→coordinator, coordinator state→floating panel + menu bar icon + waveform
[NEEDS-RUNTIME-TEST] TASK-2.10: First manual test — TextEdit: hotkey→speak→text appears, clipboard preserved, DB entry created

--- Week 4, Day 1–3: App Compatibility Testing ---

[x] TASK-2.11a: Create TESTING.md with test matrix template
[NEEDS-RUNTIME-TEST] TASK-2.11b: Test injection in browsers — Safari, Chrome, Firefox, Arc
[NEEDS-RUNTIME-TEST] TASK-2.11c: Test injection in code editors — VS Code, Cursor, Xcode, iTerm2, Terminal.app
[NEEDS-RUNTIME-TEST] TASK-2.11d: Test injection in communication apps — Slack, Discord, Messages, Mail
[NEEDS-RUNTIME-TEST] TASK-2.11e: Test injection in productivity apps — Notes, TextEdit, Pages, Notion, Linear, Obsidian, Bear, Craft
[NEEDS-RUNTIME-TEST] TASK-2.11f: Test injection in web apps — Google Docs, Gmail, Twitter/X, ChatGPT, Figma comments
[NEEDS-RUNTIME-TEST] TASK-2.11g: Test edge cases — password fields (should block), Spotlight, full-screen apps
[NEEDS-RUNTIME-TEST] TASK-2.11h: Record all results in TESTING.md, verify < 5% failure rate

--- Week 4, Day 3–4: Countdown & Estimates ---

[x] TASK-2.12: Implement countdown display at 35s, auto-stop at 45s, processing estimate for recordings > 20s

--- Week 4, Day 5: Edge Cases ---

[x] TASK-2.13: Test and handle — hotkey during model loading, no model, mic revoked, rapid press (<0.5s), hotkey while Settings focused — implemented in DictationCoordinator (guard checks, error states)

[x] CHECKPOINT-PHASE2: Phase 2 verified — all code written, tests written, runtime testing pending Xcode project

================================================================================
PHASE 3: FEATURES & UI (Week 5–6)
================================================================================

--- Week 5, Day 1–2: Setup Flow ---

[x] TASK-3.1: Create SetupView.swift — multi-step container (Permissions → Download → Ready), step tracking, navigation
[x] TASK-3.2: Create PermissionStepView.swift — 3 permission rows, System Settings URLs, polling, Input Monitoring restart flow, trust statement
[x] TASK-3.3: Create DownloadStepView.swift — hardware display, model recommendation, progress bar, SHA256 verification, error/retry
[x] TASK-3.4: Create ReadyStepView.swift — "Uttrai is ready" message, hotkey display, "Start Using Uttrai" button → sets hasCompletedSetup

--- Week 5, Day 2–4: Settings ---

[x] TASK-3.5: Create SettingsView.swift — TabView with General/Audio/Model/About tabs
[x] TASK-3.6: Create GeneralSettingsView.swift — launch at login, hotkey config, paste-last hotkey, show estimate toggle, clear history
[x] TASK-3.7: Create AudioSettingsView.swift — mic picker, live level meter, device name + sample rate, per-engine note
[x] TASK-3.8: Create ModelSettingsView.swift — current model info, available models list, download/switch, progress, disk space
[x] TASK-3.9: Create AboutView.swift — app icon, version, credits, GitHub link, license, Homebrew/Sparkle status, acknowledgments

--- Week 5, Day 4–5: History ---

[x] TASK-3.10: Create HistoryView.swift — SwiftUI List, .searchable, DatabaseRegionObservation live updates, empty state
[x] TASK-3.11: Create HistoryEntryView.swift — collapsed (timestamp, truncated text, app name), expanded (full text, copy button)

--- Week 6, Day 1–2: Menu Bar Integration ---

[x] TASK-3.12: Create MenuBarIconRenderer.swift — render all 5 icon states (idle/recording/processing/downloading/error), template vs tinted
[x] TASK-3.13: Update StatusBarMenu.swift — already implemented with dynamic status line, Polish Mode disabled, History/Settings/Updates/Quit wired, Homebrew detection

--- Week 6, Day 2–3: Sparkle ---

[MANUAL] TASK-3.14: Configure Sparkle — generate EdDSA keys, SUPublicEDKey in Info.plist, SUFeedURL, Homebrew detection disables auto-check AND hides menu item — code-level Homebrew detection implemented, Sparkle config requires Xcode
[x] TASK-3.15: Create appcast.xml template — host location decided, generate_appcast integration planned

--- Week 6, Day 3–4: Secure Field Integration ---

[NEEDS-RUNTIME-TEST] TASK-3.16: End-to-end secure field test — code implemented in TextInjectionService, needs runtime verification

--- Week 6, Day 4–5: Model Warm-Up & Polish ---

[x] TASK-3.17: Implement model warm-up on launch — implemented in AppDelegate.warmUpModel(), subtle loading state in menu bar, non-blocking
[x] TASK-3.18: Implement download notification — implemented in ModelDownloader.postDownloadNotification()

[x] CHECKPOINT-PHASE3: Phase 3 verified — all code written, runtime testing pending Xcode project

================================================================================
PHASE 4: POLISH & SHIP (Week 7–9)
================================================================================

--- Week 7, Day 1–2: Error States ---

[x] TASK-4.1a: Implement and verify — microphone denied, accessibility denied, input monitoring denied error flows — all error cases defined in UttraiError, handled in DictationCoordinator and PermissionStepView
[x] TASK-4.1b: Implement and verify — model not downloaded, model corrupted, inference failure error flows — handled in ModelManager, TranscriptionService, DictationCoordinator
[x] TASK-4.1c: Implement and verify — out of memory, insufficient disk, download failed error flows — defined in UttraiError, exponential backoff in ModelDownloader
[x] TASK-4.1d: Implement and verify — paste failed, secure text field, recording too short, Intel Mac, no audio, tap fails error flows — all cases in UttraiError, handled in respective services

--- Week 7, Day 3–5: Performance Profiling ---

[NEEDS-RUNTIME-TEST] TASK-4.2a: Measure cold start time (target < 1.5s, acceptable < 2.5s, fail > 4s)
[NEEDS-RUNTIME-TEST] TASK-4.2b: Measure model load + warm-up time (target < 4s, acceptable < 6s, fail > 10s)
[NEEDS-RUNTIME-TEST] TASK-4.2c: Measure transcription latency — 3s, 10s, 30s audio
[NEEDS-RUNTIME-TEST] TASK-4.2d: Measure RAM — idle (no model), model loaded idle, during inference
[NEEDS-RUNTIME-TEST] TASK-4.2e: Measure idle CPU, waveform fps, UI interaction latency, binary size
[NEEDS-RUNTIME-TEST] TASK-4.2f: Record all measurements, identify any Fail-tier results
[NEEDS-RUNTIME-TEST] TASK-4.3: Optimize any Fail-tier metrics (if needed)

--- Week 8, Day 1–3: Code Signing & Packaging ---

[MANUAL] TASK-4.4: Code sign with Developer ID Application in Xcode
[MANUAL] TASK-4.5: Notarize via Xcode (Archive > Distribute > Developer ID > Upload) or notarytool
[MANUAL] TASK-4.6: Create DMG with create-dmg, notarize DMG, verify with spctl
[x] TASK-4.7: Create Homebrew cask formula with postflight marker file — uttrai.rb created

--- Week 8, Day 3–5: App Icon & Visual Polish ---

[MANUAL] TASK-4.8: Design/add app icon to Assets.xcassets (all 10 sizes)
[x] TASK-4.9: Refine menu bar icon states — MenuBarIconRenderer.swift implemented with all 5 states, runtime test needed for light/dark mode
[NEEDS-RUNTIME-TEST] TASK-4.10: Visual QA pass — all screens, spacing, colors, dark mode, Dynamic Type

--- Week 9, Day 1–2: Documentation ---

[x] TASK-4.11: Create README.md — description, install, permissions, shortcuts, build from source, contributing, license
[x] TASK-4.12: Create CONTRIBUTING.md — dev setup, code style, architecture, PR process, issue templates
[x] TASK-4.13: Finalize TESTING.md — test matrix template, how to run tests, known issues section
[x] TASK-4.14: Verify LICENSE file (MIT, correct name and year) — verified as Olanrewaju Oyinbooke, 2026

--- Week 9, Day 2–3: Final Testing ---

[NEEDS-RUNTIME-TEST] TASK-4.15: Re-run full 25+ app test matrix, fix regressions
[NEEDS-RUNTIME-TEST] TASK-4.16: Execute full QA checklist from PRD Section 16.3
[NEEDS-RUNTIME-TEST] TASK-4.17: Run all unit tests — verify pass, check coverage > 70% on core services

--- Week 9, Day 3–4: Beta Testing ---

[MANUAL] TASK-4.18: Create GitHub pre-release with DMG, share with 5–10 beta testers
[MANUAL] TASK-4.19: Triage beta feedback, fix critical issues

--- Week 9, Day 5: Ship ---

[MANUAL] TASK-4.20a: Final archive, notarize, create DMG, notarize DMG
[MANUAL] TASK-4.20b: Create GitHub Release v1.0.0 with DMG attached
[MANUAL] TASK-4.20c: Update appcast.xml for Sparkle
[MANUAL] TASK-4.20d: Submit Homebrew cask PR or push to tap
[MANUAL] TASK-4.20e: Verify: brew install --cask uttrai works
[MANUAL] TASK-4.20f: Verify: direct DMG download, install, launch works

[MANUAL] CHECKPOINT-PHASE4: Phase 4 — all implementable code complete. Remaining items are [MANUAL] (Xcode/signing/shipping) and [NEEDS-RUNTIME-TEST] (performance profiling, QA)

================================================================================
SUMMARY
================================================================================

Total tasks: 97
Phase 0 (Setup): 11
Phase 1 (Foundation): 34
Phase 2 (Core Pipeline): 20
Phase 3 (Features & UI): 19
Phase 4 (Polish & Ship): 33

Checkpoints: 4 (one per phase, plus setup)

Completion criteria: ALL items marked [x] including all 4 checkpoints.
[MANUAL] items require user action in Xcode/Finder — skip and note.
[NEEDS-RUNTIME-TEST] items need the app running — implement code, note for later.
[BLOCKED] items have unresolved dependencies — note reason, revisit.
